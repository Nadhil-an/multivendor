{% extends 'base.html' %}
{% load static %}
{% block content %}

<div class="main-section">

    <!-- HEADER -->
    <div class="page-section restaurant-detail-image-section"
         style="background: url('{% if vendor.user_profile.cover_photo %}{{ vendor.user_profile.cover_photo.url }}{% else %}{% static 'images/black.jpg' %}{% endif %}') no-repeat center center/cover;">

        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="company-info-detail">

                        <div class="company-info">
                            <div class="img-holder">
                                <figure>
                                    {% if vendor.user_profile.profile_picture %}
                                        <img src="{{ vendor.user_profile.profile_picture.url }}" alt="">
                                    {% else %}
                                        <img src="{% static 'images/default.jpg' %}" alt="">
                                    {% endif %}
                                </figure>
                            </div>

                            <div class="text-holder">
                                <span class="restaurant-title">
                                    {{ vendor.vendor_name }}
                                    {% if is_open %} [ Open ] {% else %} [ Closed ] {% endif %}
                                </span>
                            </div>
                        </div>

                        <div class="delivery-timing reviews-sortby">
                            {% if opening_hours %}
                                <ul>
                                    <li>
                                        <a href="#" class="reviews-sortby-active">
                                            <span>Today :</span>

                                            {% if current_opening_hours %}
                                                {% for hour in current_opening_hours %}
                                                    <span>
                                                        {% if hour.is_closed %}
                                                            Closed
                                                        {% else %}
                                                            {{ hour.from_hour }} - {{ hour.to_hour }}
                                                        {% endif %}
                                                    </span>
                                                {% endfor %}
                                            {% else %}
                                                <span>Closed</span>
                                            {% endif %}
                                        </a>
                                    </li>
                                </ul>
                            {% endif %}
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- MENU SECTION -->
    <div class="page-section">
        <div class="container">
            <div class="row">

                <!-- SIDEBAR -->
                <div class="col-lg-3 col-md-3 col-sm-4 col-xs-12 sticky-sidebar">
                    <div class="filter-wrapper">
                        <div class="categories-menu">

                            <h6><i class="icon-restaurant_menu"></i>Categories</h6>

                            <!-- All Dishes -->
                            <a href="{% url 'vendor_details' vendor.vendor_slug %}"
                                class="{% if not selected_category %}active-category{% endif %}"
                                style="text-decoration: none; color:#C33332; font-weight:bolder; margin-top: 20px; display:block;">
                                All Dishes
                            </a>

                            {% for cat in categories %}
                                <ul class="menu-list">
                                    <li class="{% if selected_category == cat.slug %}active-category{% endif %}">
                                        <a href="{% url 'vendor_details_by_category' vendor.vendor_slug cat.slug %}"
                                           style="color: #C33332; font-weight:bold; margin-top: 20px; font-size: medium; display:block;">
                                            {{ cat.category_name }}
                                        </a>
                                    </li>
                                </ul>
                            {% endfor %}

                        </div>
                    </div>
                </div>

                <!-- MENU -->
                <div class="col-lg-9 col-md-9 col-sm-8 col-xs-12">
                    <div class="tabs-holder horizontal">

                        <ul class="stickynav-tabs nav nav-tabs">
                            <li class="active">
                                <a data-toggle="tab" href="#home">
                                    <i class="icon- icon-room_service"></i>Menu
                                </a>
                            </li>
                        </ul>

                        <div class="tab-content">
                            <div id="home" class="tab-pane in active">
                                <div class="menu-itam-holder">
                                    <div id="menu-item-list-6272" class="menu-itam-list">

                                        {% if not is_open %}
                                            <!-- SHOP CLOSED MESSAGE -->
                                            <div class="text-center p-4" style="border:1px solid #ddd; border-radius:8px;">
                                                <h3 class="text-danger"><b>Shop is Closed</b></h3>

                                                <p class="mt-2"><b>Today's Timing:</b></p>

                                                {% if current_opening_hours %}
                                                    {% for hour in current_opening_hours %}
                                                        {% if hour.is_closed %}
                                                            <p class="text-muted">Closed Today</p>
                                                        {% else %}
                                                            <p class="text-muted">{{ hour.from_hour }} - {{ hour.to_hour }}</p>
                                                        {% endif %}
                                                    {% endfor %}
                                                {% else %}
                                                    <p class="text-muted">No opening hours available</p>
                                                {% endif %}
                                            </div>

                                        {% else %}

                                            <!-- MENU LOGIC START -->

                                            {% if selected_category %}

                                                <!-- SHOW ONLY SELECTED CATEGORY -->
                                                <div class="element-title" id="menu-category-2">
                                                    <h5 class="text-color">{{ foods.first.category.category_name }}</h5>
                                                    <span>{{ foods.first.category.description }}</span>
                                                </div>

                                                    <ul>
                                                    {% for food in foods_in_cat %}
                                                        <li>
                                                            <div class="image-holder">
                                                                {% if food.image %}
                                                                    <a href="{{ food.image.url }}"><img src="{{ food.image.url }}" alt=""></a>
                                                                {% else %}
                                                                    <a><img src="{% static 'images/default-food.jpg' %}" alt=""></a>
                                                                {% endif %}
                                                            </div>

                                                            <div class="text-holder">
                                                                <h6>{{ food.food_title }}</h6>
                                                                <span>{{ food.description }}</span>
                                                            </div>

                                                            <div class="price-holder">
                                                                <span class="price">₹{{ food.price }}</span>

                                                                <a href="javascript:void(0)" class="decrease_cart"
                                                                data-id="{{ food.id }}"
                                                                data-url="{% url 'decrease_cart' food.id %}">
                                                                <i class="icon-minus text-color"></i>
                                                            </a>

                                                            <label id="qty-{{ food.id }}">0</label>

                                                            <a href="javascript:void(0)" class="add_to_cart"
                                                            data-id="{{ food.id }}"
                                                            data-url="{% url 'add_to_cart' food.id %}">
                                                                <i class="icon-plus4 text-color"></i>
                                                            </a>
                                                        </div>
                                                    </li>
                                                {% endfor %}
                                            </ul>


                                            {% else %}

                                                <!-- SHOW ALL CATEGORIES & FOODS -->
                                                {% for cat, foods_in_cat in category_with_food.items %}
                                                    <div class="element-title" id="menu-category-2">
                                                        <h5 class="text-color">{{ cat.category_name }}</h5>
                                                        <span>{{ cat.description }}</span>
                                                    </div>

                                                    <ul>
                                                        {% for food in foods_in_cat %}
                                                            <li>
                                                                <div class="image-holder">
                                                                    {% if food.image %}
                                                                        <a href="{{ food.image.url }}"><img src="{{ food.image.url }}" alt=""></a>
                                                                    {% else %}
                                                                        <a><img src="{% static 'images/default-food.jpg' %}" alt=""></a>
                                                                    {% endif %}
                                                                </div>

                                                                <div class="text-holder">
                                                                    <h6>{{ food.food_title }}</h6>
                                                                    <span>{{ food.description }}</span>
                                                                </div>

                                                                <div class="price-holder">
                                                                    <span class="price">₹{{ food.price }}</span>

                                                                    <a href="javascript:void(0)" class="decrease_cart"
                                                                        data-id="{{ food.id }}"
                                                                        data-url="{% url 'decrease_cart' food.id %}">
                                                                        <i class="icon-minus text-color"></i>
                                                                    </a>

                                                                    <label id="qty-{{ food.id }}">0</label>

                                                                    <a href="javascript:void(0)" class="add_to_cart"
                                                                        data-id="{{ food.id }}"
                                                                        data-url="{% url 'add_to_cart' food.id %}">
